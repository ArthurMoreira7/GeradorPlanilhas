<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uniautos | Gestão Pro</title>
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root {
            --primary-orange: #f39c12;
            --dark-orange: #d35400;
            --gray-dark: #2c3e50;
            --gray-bg: #f4f7f6;
            --white: #ffffff;
            --green: #27ae60;
            --red: #e74c3c;
            --shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        * { box-sizing: border-box; }

        body {
            font-family: 'Segoe UI', Tahoma, sans-serif;
            background-color: var(--gray-bg);
            margin: 0;
            color: var(--gray-dark);
        }

        /* Header com as cores originais */
        header {
            background-color: var(--gray-dark);
            color: var(--white);
            padding: 3rem 1rem;
            text-align: center;
            border-bottom: 5px solid var(--primary-orange);
        }

        header h1 { margin: 0; font-size: 2.5rem; letter-spacing: 2px; }
        header p { color: var(--primary-orange); font-weight: bold; margin-top: 5px; }

        .container { 
            max-width: 900px; 
            margin: -40px auto 40px; 
            padding: 0 20px; 
        }

        /* Dashboard Cards */
        .dashboard { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 20px; 
            margin-bottom: 30px; 
        }

        .card {
            background: var(--white);
            padding: 25px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            text-align: center;
            border-top: 4px solid var(--primary-orange);
        }

        .card h3 { margin: 0; color: #7f8c8d; font-size: 0.9rem; text-transform: uppercase; }
        .card p { margin: 10px 0 0; font-size: 1.8rem; font-weight: bold; }

        .card-receita p { color: var(--green); }
        .card-despesa p { color: var(--red); }

        /* Formulário */
        .box-panel {
            background: var(--white);
            padding: 25px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            margin-bottom: 25px;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        form { display: flex; gap: 10px; flex-wrap: wrap; }

        .input-group { flex: 1; min-width: 150px; }

        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            outline: none;
        }

        input:focus { border-color: var(--primary-orange); }

        .btn-add {
            background-color: var(--primary-orange);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
            transition: 0.3s;
        }

        .btn-add:hover { background-color: var(--dark-orange); }

        .btn-excel {
            background-color: var(--green);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Tabela */
        .table-wrapper {
            background: var(--white);
            border-radius: 10px;
            box-shadow: var(--shadow);
            overflow: hidden;
        }

        table { width: 100%; border-collapse: collapse; }
        th { background: var(--gray-dark); color: white; padding: 15px; text-align: left; }
        td { padding: 15px; border-bottom: 1px solid #eee; }

        .row-anim { transition: 0.3s; }

        .btn-delete {
            background: none;
            border: none;
            color: var(--red);
            cursor: pointer;
            font-size: 1.1rem;
            transition: 0.2s;
        }

        .btn-delete:hover { transform: scale(1.2); }

        @media (max-width: 600px) {
            .dashboard { grid-template-columns: 1fr; }
            form { flex-direction: column; }
            .section-header { flex-direction: column; gap: 15px; }
        }
    </style>
</head>
<body>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        function App() {
            const [registros, setRegistros] = useState(JSON.parse(localStorage.getItem('uniautos_db')) || []);
            const [desc, setDesc] = useState('');
            const [valor, setValor] = useState('');
            const [tipo, setTipo] = useState('receita');

            // Persistência
            useEffect(() => {
                localStorage.setItem('uniautos_db', JSON.stringify(registros));
            }, [registros]);

            // Animação inicial
            useEffect(() => {
                gsap.from(".card", { opacity: 0, y: 30, stagger: 0.2, duration: 0.6 });
            }, []);

            const handleSubmit = (e) => {
                e.preventDefault();
                const novo = { id: Date.now(), desc, valor: parseFloat(valor), tipo };
                setRegistros([novo, ...registros]);
                setDesc(''); setValor('');
                
                // Animação de entrada
                setTimeout(() => gsap.from("tr:first-child", { backgroundColor: "#fff3cd", duration: 0.5 }), 50);
            };

            const remover = (id) => {
                if(confirm("Deseja excluir?")) {
                    setRegistros(registros.filter(r => r.id !== id));
                }
            };

            const exportar = () => {
                const ws = XLSX.utils.json_to_sheet(registros.map(r => ({
                    Descrição: r.desc,
                    Valor: r.valor,
                    Tipo: r.tipo === 'receita' ? 'Entrada' : 'Saída'
                })));
                const wb = XLSX.utils.book_new();
                XLSX.utils.book_append_sheet(wb, ws, "Financeiro");
                XLSX.writeFile(wb, "Relatorio_Uniautos.xlsx");
            };

            const totalRec = registros.filter(r => r.tipo === 'receita').reduce((acc, r) => acc + r.valor, 0);
            const totalDesp = registros.filter(r => r.tipo === 'despesa').reduce((acc, r) => acc + r.valor, 0);

            return (
                <div>
                    <header>
                        <h1>UNIAUTOS</h1>
                        <p><i className="fas fa-screwdriver-wrench"></i> SISTEMA DE GESTÃO FINANCEIRA</p>
                    </header>

                    <main className="container">
                        <section className="dashboard">
                            <div className="card card-receita">
                                <h3>Receitas</h3>
                                <p>{totalRec.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</p>
                            </div>
                            <div className="card card-despesa">
                                <h3>Despesas</h3>
                                <p>{totalDesp.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}</p>
                            </div>
                        </section>

                        <section className="box-panel">
                            <div className="section-header">
                                <h3><i className="fas fa-plus"></i> Novo Registro</h3>
                                <button onClick={exportar} className="btn-excel">
                                    <i className="fas fa-file-excel"></i> Baixar Planilha
                                </button>
                            </div>

                            <form onSubmit={handleSubmit}>
                                <div className="input-group">
                                    <input value={desc} onChange={e => setDesc(e.target.value)} placeholder="Descrição" required />
                                </div>
                                <div className="input-group">
                                    <input type="number" step="0.01" value={valor} onChange={e => setValor(e.target.value)} placeholder="Valor R$" required />
                                </div>
                                <div className="input-group">
                                    <select value={tipo} onChange={e => setTipo(e.target.value)}>
                                        <option value="receita">Receita</option>
                                        <option value="despesa">Despesa</option>
                                    </select>
                                </div>
                                <button type="submit" className="btn-add">Adicionar</button>
                            </form>
                        </section>

                        <div className="table-wrapper">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Descrição</th>
                                        <th>Valor</th>
                                        <th>Tipo</th>
                                        <th style={{textAlign: 'center'}}>Ação</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {registros.map(reg => (
                                        <tr key={reg.id} className="row-anim">
                                            <td><strong>{reg.desc}</strong></td>
                                            <td style={{color: reg.tipo === 'receita' ? 'var(--green)' : 'var(--red)', fontWeight: 'bold'}}>
                                                {reg.valor.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' })}
                                            </td>
                                            <td>
                                                <span style={{
                                                    fontSize: '11px', 
                                                    fontWeight: 'bold', 
                                                    textTransform: 'uppercase',
                                                    color: reg.tipo === 'receita' ? 'var(--green)' : 'var(--red)'
                                                }}>
                                                    {reg.tipo}
                                                </span>
                                            </td>
                                            <td style={{textAlign: 'center'}}>
                                                <button onClick={() => remover(reg.id)} className="btn-delete">
                                                    <i className="fas fa-trash"></i>
                                                </button>
                                            </td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </main>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>